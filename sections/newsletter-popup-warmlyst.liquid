{{ 'section-newsletter-popup-warmlyst.css' | asset_url | stylesheet_tag }}
<script src="{{ 'newsletter-popup.js' | asset_url }}" defer="defer"></script>

<div class="newsletter-popup"
     data-newsletter-popup
     data-section-id="{{ section.id }}"
     data-delay="{{ section.settings.delay }}"
     data-exit-intent="{{ section.settings.enable_exit_intent }}"
     data-show-once="{{ section.settings.show_once_per_session }}">

  <div class="newsletter-popup__overlay" data-popup-close></div>

  <div class="newsletter-popup__modal">
    <button type="button" class="newsletter-popup__close" data-popup-close aria-label="Fermer">
      {% render 'icon-cocooning', name: 'close', size: 24 %}
    </button>

    <div class="newsletter-popup__content">
      {%- if section.settings.image != blank -%}
        <div class="newsletter-popup__image">
          <img
            src="{{ section.settings.image | image_url: width: 800 }}"
            alt="{{ section.settings.title | escape }}"
            loading="lazy"
            width="800"
            height="600"
          >
        </div>
      {%- endif -%}

      <div class="newsletter-popup__text">
        {%- if section.settings.badge_text != blank -%}
          {% render 'badge-seasonal',
            type: section.settings.badge_type,
            text: section.settings.badge_text
          %}
        {%- endif -%}

        {%- if section.settings.title != blank -%}
          <h2 class="newsletter-popup__title">{{ section.settings.title }}</h2>
        {%- endif -%}

        {%- if section.settings.description != blank -%}
          <div class="newsletter-popup__description rte">
            {{ section.settings.description }}
          </div>
        {%- endif -%}

        {%- if section.settings.show_discount_code -%}
          <div class="newsletter-popup__discount">
            <div class="discount-code">
              <span class="discount-code__label">Votre code</span>
              <span class="discount-code__value">{{ section.settings.discount_code }}</span>
            </div>
          </div>
        {%- endif -%}

        <form method="post" action="/contact#newsletter-popup" class="newsletter-popup__form" data-newsletter-form>
          <input type="hidden" name="contact[tags]" value="newsletter">

          <div class="newsletter-popup__input-wrapper">
            <input
              type="email"
              name="contact[email]"
              class="newsletter-popup__input"
              placeholder="{{ section.settings.input_placeholder }}"
              required
              autocomplete="email"
            >
            <button type="submit" class="newsletter-popup__button">
              {{ section.settings.button_text }}
            </button>
          </div>

          <div class="newsletter-popup__message" data-newsletter-message></div>
        </form>

        {%- if section.settings.show_no_thanks -%}
          <button type="button" class="newsletter-popup__no-thanks" data-popup-close>
            {{ section.settings.no_thanks_text }}
          </button>
        {%- endif -%}

        {%- if section.settings.show_trust_indicators -%}
          <div class="newsletter-popup__trust">
            <div class="trust-indicator">
              {% render 'icon-cocooning', name: 'delivery', size: 16 %}
              <span>Livraison offerte dès 50€</span>
            </div>
            <div class="trust-indicator">
              {% render 'icon-cocooning', name: 'shield', size: 16 %}
              <span>Données sécurisées</span>
            </div>
          </div>
        {%- endif -%}
      </div>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "Newsletter WARMLYST",
  "class": "section-newsletter-popup-warmlyst",
  "settings": [
    {
      "type": "header",
      "content": "Contenu"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Titre",
      "default": "10% de Réduction sur Votre Première Commande"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description",
      "default": "<p>Inscrivez-vous à notre newsletter et recevez des offres exclusives, des conseils cocooning et nos nouveautés en avant-première.</p>"
    },
    {
      "type": "text",
      "id": "badge_text",
      "label": "Texte du badge",
      "default": "Offre Exclusive"
    },
    {
      "type": "select",
      "id": "badge_type",
      "label": "Type de badge",
      "options": [
        { "value": "seasonal", "label": "Saisonnier" },
        { "value": "new", "label": "Nouveau" },
        { "value": "eco", "label": "Écologique" },
        { "value": "limited", "label": "Limité" }
      ],
      "default": "limited"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "header",
      "content": "Code de réduction"
    },
    {
      "type": "checkbox",
      "id": "show_discount_code",
      "label": "Afficher le code de réduction",
      "default": true
    },
    {
      "type": "text",
      "id": "discount_code",
      "label": "Code de réduction",
      "default": "BIENVENUE10",
      "info": "Créez d'abord le code dans Marketing > Réductions"
    },
    {
      "type": "header",
      "content": "Formulaire"
    },
    {
      "type": "text",
      "id": "input_placeholder",
      "label": "Placeholder de l'input",
      "default": "Votre adresse e-mail"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Texte du bouton",
      "default": "S'inscrire"
    },
    {
      "type": "checkbox",
      "id": "show_no_thanks",
      "label": "Afficher 'Non merci'",
      "default": true
    },
    {
      "type": "text",
      "id": "no_thanks_text",
      "label": "Texte 'Non merci'",
      "default": "Non merci, je préfère payer le prix fort"
    },
    {
      "type": "checkbox",
      "id": "show_trust_indicators",
      "label": "Afficher indicateurs de confiance",
      "default": true
    },
    {
      "type": "header",
      "content": "Comportement"
    },
    {
      "type": "checkbox",
      "id": "enable_exit_intent",
      "label": "Activer exit intent",
      "info": "Affiche le popup quand l'utilisateur s'apprête à quitter la page",
      "default": true
    },
    {
      "type": "range",
      "id": "delay",
      "label": "Délai d'affichage (secondes)",
      "info": "Si exit intent est désactivé, affiche après ce délai",
      "min": 0,
      "max": 60,
      "step": 5,
      "default": 10
    },
    {
      "type": "checkbox",
      "id": "show_once_per_session",
      "label": "Afficher une seule fois par session",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Newsletter WARMLYST",
      "settings": {
        "title": "10% de Réduction sur Votre Première Commande",
        "badge_text": "Offre Exclusive"
      }
    }
  ]
}
{% endschema %}
